

<div style="display: flex">
  <button
    [ngClass]="{ active: tabToggle === false }"
    (click)="loadSelectedTabData('dashboard')"
  >
    Dashboard
  </button>
  <button
    [ngClass]="{ active: tabToggle === true }"
    (click)="loadSelectedTabData('insights')"
  >
    Insights
  </button>
</div>

<div class="row col-md-12 col-lg-3 col-xxxl-3" *ngIf="tabToggle">
  <div>
    <nb-card>
      <nb-card-header>Client</nb-card-header>
      <nb-card-body>
        <nb-select
          placeholder="Select Client:"
          id="clientSelect"
          [(selected)]="defaultSelectedClient"
          (selectedChange)="onClientChange($event)"
        >
          <nb-option *ngFor="let client of clientNames" [value]="client">
            {{ client }}
          </nb-option>
        </nb-select>
      </nb-card-body>
    </nb-card>
  </div>

  <div class="col-md-12 col-lg-3 col-xxxl-3">
    <nb-card>
      <nb-card-header>Users</nb-card-header>
      <nb-card-body>
        <nb-select
          placeholder="Select UserId"
          id="userSelect"
          [(selected)]="selectedUsername"
          (selectedChange)="onUserChange()"
        >
          <nb-option
            *ngFor="let user of dataService.userDropdownData"
            [value]="user.id"
          >
            {{ user.value }}
          </nb-option>
        </nb-select>
      </nb-card-body>
    </nb-card>
  </div>

  <div class="col-md-12 col-lg-3 col-xxxl-3">
    <nb-card>
      <nb-card-header>Date</nb-card-header>
      <nb-card-body>
        <nb-select
          placeholder="Select Date"
          id="dateSelect"
          [(selected)]="selectedDate"
          (selectedChange)="loadDatesForUser(selectedUsername)"
        >
          <nb-option *ngFor="let date of userEventDates" [value]="date.id">
            {{ date.value }}
          </nb-option>
        </nb-select>
      </nb-card-body>
    </nb-card>
  </div>


  
  <div class="col-md-12 col-lg-12 col-xxxl-12">
    <nb-card class="high-chart" size="large">
      <div id="container" style="width: 100%; height: 450px"></div>
    </nb-card>
  </div>
</div>



<div class="row" *ngIf="tabToggle">
  <div class="col-md-12 col-lg-12 col-xxxl-12" >
    <h4>Screens Overview</h4>
    <div class="row gap-1 main-container" style="max-height: 500px; overflow-y: auto;">     
      <ng-container *ngFor="let s of screensList">
        <div class="card col-md-3 col-lg-3">
          <h2>{{ s.pageName }}</h2>
          <ul>
            <li *ngFor="let e of s.actions">
              <span>{{ e.key }}</span><strong>{{ e.value }}</strong>
            </li>
          </ul>
        </div>
      </ng-container>
    </div>
  </div>
</div>

<div class="flow-graph row" *ngIf="tabToggle">
  <div class="col-lg-12 col-md-12 col-sm-12">
    <ol>
      <ng-container *ngFor="let s of screensList; let i = index">
        <li>
          <button class="btn" 
                  [class.btn-primary]="isSelected(s)" 
                  [class.btn-selected]="isSelected(s)" 
                  (click)="toggleTooltip($event, s.actions); setSelected(s)"
                  title="View clicked buttons"
                  >
            <span>{{ s.pageName + ' page' }}</span>
            
          </button>
        </li>
      </ng-container>
    </ol>
  </div>
</div>

<ng-container *ngIf="showActionsTooltip && tabToggle" class="tooltip" [style.top.px]="tooltipTop" [style.left.px]="tooltipLeft" >
  <div class="tooltip-content">
    <span *ngFor="let action of tooltipActions">{{ action }}</span>
  </div>
</ng-container>

<div *ngIf="!tabToggle">
  
  <figure class="highcharts-figure">
    <div id="parent-container">
      <div id="pieChartContainer"></div>
      <div id="total-count" class="center-label"></div>
    </div>

  </figure>

</div>
